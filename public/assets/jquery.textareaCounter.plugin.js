/*
 * jQuery Textarea Characters Counter Plugin v 2.0
 * Examples and documentation at: http://roy-jin.appspot.com/jsp/textareaCounter.jsp
 * Copyright (c) 2010 Roy Jin
 * Version: 2.0 (11-JUN-2010)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 * Requires: jQuery v1.4.2 or later
 */
(function(e){e.fn.textareaCount=function(t,n){function c(){return o.html(h()),typeof n!="undefined"&&n.call(this,d()),!0}function h(){var e=i.val(),n=e.length;if(t.maxCharacterSize>0){n>=t.maxCharacterSize&&(e=e.substring(0,t.maxCharacterSize));var r=g(e),s=t.maxCharacterSize-r;m()||(s=t.maxCharacterSize);if(n>s){var c=this.scrollTop;i.val(e.substring(0,s)),this.scrollTop=c}o.removeClass(t.warningStyle),s-n<=t.warningNumber&&o.addClass(t.warningStyle),u=i.val().length+r,m()||(u=i.val().length),l=b(y(i.val())),f=a-u}else{var r=g(e);u=i.val().length+r,m()||(u=i.val().length),l=b(y(i.val()))}return p()}function p(){var e=t.displayFormat;return e=e.replace("#input",u),e=e.replace("#words",l),a>0&&(e=e.replace("#max",a),e=e.replace("#left",f)),e}function d(){var e={input:u,max:a,left:f,words:l};return e}function v(e){return e.next(".charleft")}function m(){var e=navigator.appVersion;return e.toLowerCase().indexOf("win")!=-1?!0:!1}function g(e){var t=0;for(var n=0;n<e.length;n++)e.charAt(n)=="\n"&&t++;return t}function y(e){var t=e+" ",n=/^[^A-Za-z0-9]+/gi,r=t.replace(n,""),i=rExp=/[^A-Za-z0-9]+/gi,s=r.replace(i," "),o=s.split(" ");return o}function b(e){var t=e.length-1;return t}var r={maxCharacterSize:-1,originalStyle:"originalTextareaInfo",warningStyle:"warningTextareaInfo",warningNumber:20,displayFormat:"#input characters | #words words"},t=e.extend(r,t),i=e(this);e("<div class='charleft'>&nbsp;</div>").insertAfter(i);var s={width:i.width()},o=v(i);o.addClass(t.originalStyle),o.css(s);var u=0,a=t.maxCharacterSize,f=0,l=0;i.bind("keyup",function(e){c()}).bind("mouseover",function(e){setTimeout(function(){c()},10)}).bind("paste",function(e){setTimeout(function(){c()},10)})}})(jQuery);