jQuery(function(a){a("form a.add_nested_fields").live("click",function(){var b=a(this).attr("data-association"),c=a("#"+b+"_fields_blueprint").html(),d=(a(this).closest(".fields").find("input:first").attr("name")||"").replace(new RegExp("[[a-z]+]$"),"");if(d){var e=d.match(/[a-z_]+_attributes/g)||[],f=d.match(/(new_)?[0-9]+/g)||[];for(i=0;i<e.length;i++)f[i]&&(c=c.replace(new RegExp("(_"+e[i]+")_.+?_","g"),"$1_"+f[i]+"_"),c=c.replace(new RegExp("(\\["+e[i]+"\\])\\[.+?\\]","g"),"$1["+f[i]+"]"))}var g=new RegExp("new_"+b,"g"),h=(new Date).getTime();return c=c.replace(g,"new_"+h),a(this).before(c),a(this).closest("form").trigger("nested:fieldAdded"),!1}),a("form a.remove_nested_fields").live("click",function(){var b=a(this).prev("input[type=hidden]")[0];return b&&(b.value="1"),a(this).closest(".fields").hide(),a(this).closest("form").trigger("nested:fieldRemoved"),!1})})